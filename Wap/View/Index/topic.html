
<!DOCTYPE html>
<html dir="ltr">
<head>
    <title>名叔馆</title>
    <include file="Index:wap_js_css"/>
</head>
<style>
    .subnav-inverse { background-color: #3F4144; color: #fff;}
    .subnav-elements {
        padding: 8px 10px;
        position: relative;
        -webkit-box-sizing: border-box;
        -moz-box-sizing: border-box;
        box-sizing: border-box;
        width: 100%;
    }
    .btn-group {
        position: relative;
        display: inline-block;
        font-size: 0;
        vertical-align: middle;
        white-space: nowrap;
    }

    .btn-group>.btn:hover, .btn-group>.btn:focus, .btn-group>.btn:active, .btn-group>.btn.active {
        z-index: 2;
    }
    .btn-group>.btn:first-child {
        margin-left: 0;
        -webkit-border-top-left-radius: 4px;
        -moz-border-radius-topleft: 4px;
        border-top-left-radius: 4px;
        -webkit-border-bottom-left-radius: 4px;
        -moz-border-radius-bottomleft: 4px;
        border-bottom-left-radius: 4px;
    }
    a.btn-inverse.active {
        background-color: #222;
    }
    .flex .nav-item, .list-item.flex .nav-item, .flex .flex-item, .list-item.flex .flex-item {
        -moz-box-align: center;
        -webkit-box-align: center;
        -webkit-align-items: center;
        -ms-flex-align: center;
        align-items: center;
        -moz-box-flex: 1;
        -webkit-box-flex: 1;
        -webkit-flex: 1;
        -ms-flex: 1;
        flex: 1;
        display: block;
    }
    .btn-group>.btn, .btn-group>.dropdown-menu, .btn-group>.popover {
        font-size: 20px;
        width: 50%;
    }
    .btn-group>.btn {
        position: relative;
        -webkit-border-radius: 0;
        -moz-border-radius: 0;
        border-radius: 0;
    }
    a.btn-inverse {
        background-color: #555;
    }
    .content-list.conversations{width: 98%;margin: 0 auto}
</style>
<link rel="stylesheet" type="text/css" href="__STATIC__/common/css/component.css"/>
<body class="bodyf">
<div id="page" style="height: auto; overflow: visible;">
    <include file="Index:head"/>
    <div id="signupOverlay" class="absolute" style="width: 100%; ">
        <div id="content" class="is-fadein is-shown">
            <div class="subnav-elements subnav-inverse flex btn-group tc clof" style="margin-top: 47px;height: 47px;">
                <a id="SavedBtn" data-tit="topic" class="btn btn-inverse nav-item active"><i class="fa fa-file-word-o"></i></a>
                <a id="inboxBtn" data-tit="rk" class="btn btn-inverse nav-item "><i class="fa fa-envelope"></i></a>
            </div>
            <ul id="topicbox" class=" content-list conversations relative">
            </ul>
            <ul id="rkbox" class="hide content-list conversations relative">
            </ul>
            <div id="showMoreContainer" class="center" onclick="getmore();">
                <div class="box-padding show-more is-rendered-hidden">
                    <div class="label box-padding center clo6">
                        显示更多 &nbsp;<i class="icon-chevron-down"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    var page=0;
    $('.subnav-elements.subnav-inverse a.btn-inverse').click(function(){
        $('.subnav-elements.subnav-inverse a.btn-inverse').removeClass('active');
        $('ul.content-list.conversations').addClass('hide');
        $(this).addClass('active');
        if($(this).data('tit') == 'topic'){
            page=0;
            getTopicInfo();
            $('#topicbox').removeClass('hide');
        }else{
            page=0;
            getrkInfo();
            $('#rkbox').removeClass('hide');
        }
    })

    function getmore(){
         if( $('.subnav-elements.subnav-inverse a.active').data('tit') == 'topic'){
            getTopicInfo();
        }else{
            getrkInfo();
        }
    }

    getTopicInfo();
    function getrkInfo(){
        $.post('/index/getrkInfo.html',{page:page},function(data){
            if(data.code ==200){
                var obj = data.data,$html='';
                if(obj){
                    for(var i in obj){
                        $html+='<li>';
                        $html+='<a class="topic-itme " href="/index/plan.html?pid='+obj[i]['pid']+'">';
                        $html+='<div class="topic_tit clo3 font16 fontb">'+obj[i]['title']+'</div>';
                        $html+='<div class="topic_content font14 clo6 " style="margin: 10px 0">'+obj[i]['contentcn']+'</div>';
                        $html+=' </a>';
                        $html+=' </li>';
                        $html+='<li><div class="line10"></div></li>';
                    }
                    if(page ==0){
                        $('#rkbox').html($html);
                    }else{
                        $('#rkbox').append($html);
                    }
                    page++;
                }else{
                    $('#showMoreContainer').hide();
                    clearpop('没有更多了');
                }
            }else{
                clearpop(data.message);
            }
        })
    }
    function getTopicInfo(){
        $.post('/index/getinfolist.html',{page:page},function(data){
            if(data.code ==200){
                var obj = data.data,$html='';
                if(obj){
                    for(var i in obj){
                        $html+='<li>';
                        $html+='<a class="topic-itme " href="/index/topicInfo.html?tid='+obj[i]['tid']+'">';
                    $html+='<div class="container">';
                    $html+='<div class="topic_tit clo3 font16 fontb">';
                    $html+='<span class="red">#'+obj[i]['clubname']+'#</span>'+obj[i]['title']+'</div>';
                    $html+='<div class="topic_content font14 clo6 " style="margin: 10px 0">';
                    $html+=obj[i]['message'];
                    if(obj[i]['img']){
                        for(var j in obj[i]['img']){
                            $html+='<img src="__PUBLIC__/'+ obj[i]['img'][j]+'" style="max-width: 100%"  alt=""/>';
                        }
                    }
                    $html+='</div>';
                    $html+='<div class="topic_u_info bordert-d">';
                    $html+='<div class="fl">';
                    if(obj[i]['avatar']){
                        $html+='<img src="'+(PUBLIC+obj[i]['avatar'])+'" width="30" alt=""/>';
                    }else{
                        $html+='<img src="__STATIC__/image/defaultAvatar.png" width="30" alt=""/>';
                    }
                    $html+='<span class="clo3">'+obj[i]['nickname']+'&nbsp;</span>';
                    $html+='</div>';
                    $html+='<div class="clo9 fr topic-c-time font12"> <span>阅读'+ (parseInt(obj[i]['read'])+0)+'</span>';
                    $html+='&nbsp;<span>评论'+ (parseInt(obj[i]['comments'])+0)+'</span></div>';
                    $html+='</div>';
                    $html+='</div>';
                    $html+=' </a>';
                    $html+=' </li>';
                    $html+='<li><div class="line10"></div></li>';
                    }
                    if(page ==0){
                        $('#topicbox').html($html);
                    }else{
                        $('#topicbox').append($html);
                    }
                    page++;
                }else{
                    $('#showMoreContainer').hide();
                    clearpop('没有更多了');
                }
            }else{
                clearpop(data.message);
            }
        })
    }
</script>
</body>
</html>