<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>等级列表</title>
<include file="Index:_js_css" />
</head>
<body data-maxlevel="{$maxlevel}">
<table border="0" class="mytables" style="width: 100%;">
		<thead>
            <td colspan="6" class="tc">【 管理等级 】</td>
		</thead>
		<tr align="center">
			<th width="50">ID</th>
			<th>等级名称</th>
			<th width="50">等级</th>
			<th >所需积分</th>
			<th width="50">状态</th>
			<th width="110">操作</th>
		</tr>
		<volist id="vo" name="list">
		<tr  align="center" id="row_{$vo.id}" data-name="{$vo.name}" data-level="{$vo.level}" data-integrate="{$vo.integrate}">
			<td>{$vo.id}</td>
			<td><a href="{:U('Member/member','searchtype=4&keyword='.$vo['id'])}">{$vo.name}</a></td>
			<td>{$vo.level}</td>
			<td>{$vo.integrate}</td>

			<td><if condition="($vo.status eq 1)"> <a
					href="javascript:void(0);"
					onclick="setVal('level','status',{$vo.id},-1,this,'禁用')">启用</a> <else />
				<a href="javascript:void(0);"
					onclick="setVal('level','status',{$vo.id},1,this,'启用')">禁用</a> </if></td>
			<td> <a href="javascript:showlevelbox('{$vo.id}');" >修改</a>
				<a href="javascript:delLevel('{$vo.id}');" >删除</a></td>
		</tr>
		</volist>
        <tr><td align="right" colspan="6" > <a href="javascript:showlevelbox();" style="margin-right: 50px;;">添加</a></td></tr>
	</table>
	<include file="Index:footer" />

    <form id="levelbox" style="display: none" onsubmit="return false;" >
        <input type="hidden" name="id"/>
        <div class="form-group">
            <label for="exampleInputname">等级名</label><input type="text" name="name" class="form-control" id="exampleInputname" />
        </div>
        <div class="form-group">
            <label for="exampleInputlevel">等级</label><input type="text" name="level" class="form-control" id="exampleInputlevel" value="" readonly/>
        </div>
        <div class="form-group">
            <label for="exampleInputintegrate">所需积分</label><input type="text" name="integrate" class="form-control" id="exampleInputintegrate" />
        </div>
        <button type="submit" class="btn btn-default" onclick="modifylevel();">提交</button>
    </form>
<script>
    function showlevelbox(id) {
        if(id){
            $('#levelbox input[name=id]').val(id);
            $('#levelbox input[name=name]').val($('#row_'+id).data('name'));
            $('#levelbox input[name=level]').val($('#row_'+id).data('level'));
            $('#levelbox input[name=integrate]').val($('#row_'+id).data('integrate'));
        }else{
            $('#levelbox input[name=level]').val(parseInt($('body').data('maxlevel'))+1);
        }

        getMask().maskShow({"tit": "添加/修改等级","width":480, "cont": "#levelbox"});
    }

    function delLevel($id){
        if(confirm('您确定删除该记录吗？')){
            $.post('/admin/member/delLevel.html',{id:$id},function(data){
                clearpop(data.message);
                if(data.code == 200){
                    $('#row_'+$id).remove();
                }
            })
        }
    }

    function modifylevel(){
        var id = $('#levelbox input[name=id]').val();
        var name = $('#levelbox input[name=name]').val();
        var level = $('#levelbox input[name=level]').val();
        var integrate = $('#levelbox input[name=integrate]').val();
        $.post('/admin/member/modifylevel.html',{id:id,name:name,level:level,integrate:integrate},function(data){
            if(data.code == 200){
                clearpop(data.message,'','self');
            }else{
                clearpop(data.message);
            }
        })
    }
</script>
</body>
</html>